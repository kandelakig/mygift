<html>
	<head>
		<link rel="stylesheet" type="text/css" href="style/popup.css">
		<script type="text/javascript" src="lib/jquery.js"></script>
		<script type="text/javascript">
			function showSuggestions(historyItems) {
				historyItems.forEach(function(item, index){
					var row;
					if (index%3 == 0) {
						row = $("<tr/>", {id: "suggestions-row-"+index/3});
						$("table#suggestions-table > tbody").append(row);
					} else {
						row = $("tr#suggestions-row-"+Math.floor(index/3));
					}

					var cell = $("<td/>", {id: "suggestions-cell-"+index});

					row.append(cell);
					
					cell.append($("<a/>", {"href": "#", "onClick": "chrome.tabs.create({url: '" + item.url + "'});"}).append(item.title));
				})
			}

			$(function () {
				var bgPage = chrome.extension.getBackgroundPage();
				bgPage.getHistory().then(showSuggestions);
				$("#submit-button").click(function() {
					chrome.tabs.getSelected(null, bgPage.sendRequest);
					close();
				});
			});
		</script>
	</head>

	<body>
		<div id="popup-box">
			<div>
				<input type="button" id="submit-button" value="Buy it for me!" />
			</div>
			<div id="suggestion-box">
				<label id="suggestions">Suggestions</label>
				<table id="suggestions-table">
					<tbody>
					</tbody>
				</table>
			</div>
		</div>
	</body>
</html>